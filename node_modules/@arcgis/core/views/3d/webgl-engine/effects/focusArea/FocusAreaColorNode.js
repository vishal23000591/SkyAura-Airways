/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../../chunks/tslib.es6.js";import{property as r}from"../../../../../core/accessorSupport/decorators/property.js";import"../../../../../core/has.js";import"../../../../../core/Logger.js";import"../../../../../core/RandomLCG.js";import{subclass as s}from"../../../../../core/accessorSupport/decorators/subclass.js";import{InternalRenderCategory as o}from"../../../webgl.js";import t from"../../../webgl/RenderNode.js";import{FocusAreaColorTechnique as i}from"./FocusAreaColorTechnique.js";import{FocusAreaEffect as c}from"./FocusAreaEffect.js";import{F as a}from"../../../../../chunks/FocusAreaColor.glsl.js";import{DepthStencilAttachment as p}from"../../../../webgl/enums.js";let m=class extends t{constructor(e){super({...e,view:e.focusAreasView.view}),this.consumes={required:[o.FOCUSAREA_COLOR,o.FOCUSAREA]},this.produces=o.FOCUSAREA_COLOR,this._passParameters=new a}precompile(){this.techniques.precompile(i)}render(e){const r=this.techniques.get(i),s=e.find((({name:e})=>e===this.produces));if(!r.compiled)return this.requestRender(),s;const t=this.focusAreasView.style,c=this.bindParameters,a=c.camera,m=a.fullViewport[2],n=a.fullViewport[3],f=e.find((({name:e})=>e===o.FOCUSAREA)),h=this.fboCache.acquire(m,n,this.produces),d=this.renderingContext;return d.bindFramebuffer(h.fbo),this._passParameters.color=s.getTexture(),this._passParameters.focusArea=f.getTexture(),this._passParameters.effect=u[t],d.bindTechnique(r,c,this._passParameters),d.screen.draw(),h.attachDepth(s.getAttachment(p)),h}};e([r()],m.prototype,"consumes",void 0),e([r()],m.prototype,"produces",void 0),e([r({constructOnly:!0})],m.prototype,"focusAreasView",void 0),m=e([s("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaColorNode")],m);const u={bright:c.BRIGHT,dark:c.DARK};export{m as FocusAreaColorNode};
