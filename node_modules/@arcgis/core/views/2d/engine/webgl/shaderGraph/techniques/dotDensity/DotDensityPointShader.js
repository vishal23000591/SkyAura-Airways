/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import{_ as t,a as o}from"../../../../../../../chunks/tslib.es6.js";import{tileSize as e}from"../../../definitions.js";import{GraphShaderModule as i,FragmentOutput as s,location as r,uniform as d,input as n,VertexInput as a,UniformGroup as p}from"../../GraphShaderModule.js";import{Mat3 as l,Vec3 as c,texture2D as m,max as y,Float as u,step as v,Vec4 as w,length as h,smoothstep as x,Vec2 as f,Sampler2D as g}from"../../graph/glsl.js";import{FeatureFragmentInput as S}from"../shaders/AFeatureShader.js";import{ViewInfo as j}from"../shaders/ViewInfo.js";class z extends a{}t([r(0,f)],z.prototype,"pos",void 0);class P extends S{}class R extends p{}t([d(u)],R.prototype,"dotSize",void 0);class b extends p{}t([d(g)],b.prototype,"locations",void 0),t([d(u)],b.prototype,"pixelRatio",void 0),t([d(u)],b.prototype,"tileZoomFactor",void 0);const F=1e-6;class C extends i{constructor(){super(...arguments),this.type="DotDensityPointShader"}vertex(t){const o=new l(1,0,0,0,-1,0,0,1,1).multiply(new c(t.pos.xy.divide(e),1)),i=m(this.draw.locations,o.xy),s=y(this.instance.dotSize.divide(2),new u(1));let r=new u(0);r=r.add(v(i.a,new u(F)).multiply(2));let d=s.add(this.instance.dotSize);const n=this.view.displayViewScreenMat3.multiply(new c(t.pos.add(.5),1)),a=new w(n.xy,r,1),p=this.instance.dotSize.divide(d),h=new u(-1).divide(s.divide(d));return d=d.multiply(this.draw.pixelRatio.multiply(this.draw.tileZoomFactor)),{glPosition:a,glPointSize:d,color:i,ratio:p,invEdgeRatio:h}}fragment(t){const o=h(t.glPointCoord.subtract(.5)).multiply(2),e=x(new u(0),new u(1),t.invEdgeRatio.multiply(o.subtract(t.ratio)).add(1)),i=new s;return i.fragColor=t.color.multiply(e),i}}t([d(R)],C.prototype,"instance",void 0),t([d(b)],C.prototype,"draw",void 0),t([d(j)],C.prototype,"view",void 0),t([o(0,n(z))],C.prototype,"vertex",null),t([o(0,n(P))],C.prototype,"fragment",null);export{b as DotDensityPointDrawUniforms,P as DotDensityPointFragmentInput,R as DotDensityPointInstanceUniforms,C as DotDensityPointShader,z as DotDensityPointVertexInput};
